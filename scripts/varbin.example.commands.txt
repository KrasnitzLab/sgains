
#####  one step at a time = map, sort, rmdup

#  map using bowtie 1
/mnt/wigclust5/data/safe/kendall/bowtie-0.12.7/bowtie -S -t -n 2 -e 70 --chunkmbs 256 -3 18 -5 8 -m 1 --best --strata --solexa-quals hg19 <(gunzip -c /mnt/wigstore3/user/autism/RAW-whole-genome/AC017KABXX/s_2_1_sequence.txt.gz) | /data/safe/kendall/samtools-0.1.19/samtools view -Sbu -o paa0001.bam - 

# sort into genome order
/data/safe/kendall/samtools-0.1.19/samtools sort paa0001.bam paa0001.sorted

# remove duplicate reads
/data/safe/kendall/samtools-0.1.19/samtools rmdup paa0001.sorted.bam paa0001.rmdup.bam

# index bam file
/data/safe/kendall/samtools-0.1.19/samtools index paa0001.rmdup.bam




#####  alternate pipeline  (head -n 1000000 to test quickly)  no need to write and read .bam and .sorted.bam, only write .rmdup.bam at end of pipeline.

/mnt/wigclust5/data/safe/kendall/bowtie-0.12.7/bowtie -S -t -n 2 -e 70 --chunkmbs 256 -3 18 -5 8 -m 1 --best --strata --solexa-quals hg19 <(gunzip -c /mnt/wigstore3/user/autism/RAW-whole-genome/AC017KABXX/s_2_1_sequence.txt.gz | head -n 1000000 ) | /mnt/wigclust5/data/safe/kendall/samtools-0.1.19/samtools view -Sbu -o - - | /mnt/wigclust5/data/safe/kendall/samtools-0.1.19/samtools sort -o - - | /mnt/wigclust5/data/safe/kendall/samtools-0.1.19/samtools rmdup - paa0001x.rmdup.bam

# index bam file
/mnt/wigclust5/data/safe/kendall/samtools-0.1.19/samtools index paa0001x.rmdup.bam




#  run varbin
python /mnt/wigclust5/data/safe/kendall/kuhn04/hg19.50k/programs/varbin.20k.sam.py <(/data/safe/kendall/samtools-0.1.19/samtools view paa0001.rmdup.bam) /mnt/wigclust5/data/safe/kendall/paa02/paa0001.varbin.20k.txt /mnt/wigclust5/data/safe/kendall/paa02/paa0001.varbin.20k.stats.txt

#  run segmentation script
/usr/bin/R CMD BATCH --no-restore --no-save paa0001.cbs.20k.r /data/safe/kendall/paa02/paa0001.cbs.20k.r.out

